<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>STLL: Drawing the layouts</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">STLL
   &#160;<span id="projectnumber">0.0</span>
   </div>
   <div id="projectbrief">Simple Text Layouting Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('drawing_pg.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Drawing the layouts </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>When it comes to drawing the final layout there are quite some choices to make. This page will try to explain some of the available options.</p>
<p>Not all output drivers will support all the available options. Please read there for further information</p>
<h1><a class="anchor" id="gamma_sec"></a>
Gamma</h1>
<p>Some output drivers support gamma correct blending when drawing. That means they can be used to draw onto surfaces that do have a non linear intensity curve.</p>
<p>Most consumer level displays do have a non linear intensity curve, that means that the grey with the intensity values 128 is not half as bright as the one with intensity 255.</p>
<p>This has repercussions on blending. When not correctly done it will result in black shadows along blend lines and in letters that appear too thin.</p>
<p>To resolve this problem use the following rules:</p><ul>
<li>when drawing into a display buffer use the gamma value of 2.2</li>
<li>when drawing into non display buffers use gamma 1 (but make sure that you properly blend when you draw that buffer onto the surface</li>
</ul>
<p>The SDL output driver provides gamma values for output. OpenGL provides the possibility to set framebuffers to sRGB which results in proper blending when drawn into.</p>
<h1><a class="anchor" id="subpixel_sec"></a>
Sub pixel placement</h1>
<p>Sub pixel placement allows more accurate placement of pixels onto the screen. It requires a 1:1 correspondence between the framebuffer and the display, so it doesn't work on CRTs and it also doesn't work when the display has to scale the framebuffer.</p>
<p>But when all conditions are met you will get a sharper result and more evenly distributed letters.</p>
<p>The output routines need to know the sub pixel arrangement to make the right drawing decisions. If you can not find out and don't want to ask the user for that information don't use it. When used wrongly it will result in ugly output.</p>
<p>Also keep in mind that drawing with sub pixel placement is not possible on surfaces that include an alpha channel because the resulting surface can not properly drawn onto any other surface. This would require separate alpha channel for each colour component.</p>
<p>Sub pixel drawing only properly works when drawing directly onto the target. When drawing onto surfaces with an alpha channel, the alpha of all the pixels are untouched assuming that the background is properly prepared for the glyphs (e.g. opaque)</p>
<h1><a class="anchor" id="outputclasses_sec"></a>
Output Classes</h1>
<p>Output functions are always a member of a class. These classes encapsulate the state for drawing, but more importantly they encapsulate the glyph cache.</p>
<p>The glyph cache is there to avoid unnecessary re-rasterization of the glyphs. Each output class might come with its own type of cache.</p>
<p>When you want to draw you create an instance of those classes and then use the draw function of that instance.</p>
<h1><a class="anchor" id="opengl_sec"></a>
OpenGL drawing</h1>
<p><a class="el" href="namespace_s_t_l_l.html" title="The namespace for the library. Every function and class is within this namespace. ...">STLL</a> comes with 3 different OpenGL output classes. Each one is intended for usage with a certain version of OpenGL. All classes have the same name, the only thing that changes is the header that you need to include.</p><ul>
<li>output_OpenGL_1.h contains an OpenGL output class for OpenGL up to version 1.1. It uses the fixed function pipeline and display lists. Sub-pixel placement requires 3 drawing passes</li>
<li>output_OpenGL_2.h contains the output class for OpenGL 2.0 - 2.1. It uses vertex buffers and shaders for output. It also requires 3 drawing passes</li>
<li>output_OpenGL_3.h is intended for OpenGL starting with version 3.0. It uses vertex array objects and the ARB_BlendFuncExtended extension for single pass sub-pixel placement</li>
</ul>
<p>All 3 OpenGL output classes use the same type of glyph-cache: a texture atlas. The functions will place as many glyphs of the layout to show into the atlas output that portion, wipe the atlas and refill it with the next batch until it is filled and so on. So it is important for performance to have a texture atlas that is big enough to hold all required glyphs.</p>
<p>All OpenGL classes return an object that you can store together with the layout and that you can give as a parameter to the drawing function for an additional performance gain. This object contains the display lists or vertex arrays created. When the drawing function is called with a valid instance of this class and it can confirm that the texture atlas used then is still valid it will not recreate the vertex buffer and instead directly draw what is in there.</p>
<p>But this only works when the texture cache has not been invalidated since the creation of the vertex buffer and if the drawing command can be done in one pass. So keep your texture atlas the right size.</p>
<p>A few tips regarding texture atlas usage:</p><ul>
<li>stay away from blurr, it occupies quite a bit more space than a normal glyph. It also requires underlines to be within the cache, or at least keep the blurr very small</li>
<li>sub-pixel output reqires 3 times as much space as normal antialiased output</li>
<li>you can get a pointer to the cache with the getData funtion to see how much is occupied </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Jan 28 2016 21:45:13 for STLL by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
